[{"sql":["CREATE TYPE \"public\".\"account_types\" AS ENUM('Brukskonto', 'Sparekonto', 'BSU', 'Depositumskonto');","\nCREATE TYPE \"public\".\"role_types\" AS ENUM('Advisor', 'User');","\nCREATE TYPE \"public\".\"transaction_types\" AS ENUM('Overf√∏ring', 'Betaling', 'Innskudd', 'Uttak');","\nCREATE TABLE IF NOT EXISTS \"accounts\" (\n\t\"id\" serial PRIMARY KEY NOT NULL,\n\t\"account_number\" varchar(11) NOT NULL,\n\t\"name\" text NOT NULL,\n\t\"owner_id\" integer NOT NULL,\n\t\"type\" \"account_types\" NOT NULL,\n\tCONSTRAINT \"accounts_account_number_unique\" UNIQUE(\"account_number\")\n);\n","\nCREATE TABLE IF NOT EXISTS \"account_transactions\" (\n\t\"id\" serial PRIMARY KEY NOT NULL,\n\t\"description\" text NOT NULL,\n\t\"amount\" numeric NOT NULL,\n\t\"timestamp\" timestamp NOT NULL,\n\t\"account_id\" integer NOT NULL,\n\t\"type\" \"transaction_types\" NOT NULL,\n\t\"approved\" timestamp\n);\n","\nCREATE TABLE IF NOT EXISTS \"triggers\" (\n\t\"id\" serial PRIMARY KEY NOT NULL,\n\t\"name\" text NOT NULL\n);\n","\nCREATE TABLE IF NOT EXISTS \"users\" (\n\t\"id\" serial PRIMARY KEY NOT NULL,\n\t\"nnin\" text NOT NULL,\n\t\"name\" text NOT NULL,\n\t\"role\" \"role_types\" DEFAULT 'User'\n);\n","\nDO $$ BEGIN\n ALTER TABLE \"accounts\" ADD CONSTRAINT \"accounts_owner_id_users_id_fk\" FOREIGN KEY (\"owner_id\") REFERENCES \"public\".\"users\"(\"id\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nDO $$ BEGIN\n ALTER TABLE \"account_transactions\" ADD CONSTRAINT \"account_transactions_account_id_accounts_id_fk\" FOREIGN KEY (\"account_id\") REFERENCES \"public\".\"accounts\"(\"id\") ON DELETE no action ON UPDATE no action;\nEXCEPTION\n WHEN duplicate_object THEN null;\nEND $$;\n","\nCREATE MATERIALIZED VIEW \"public\".\"account_balance\" AS (select \"account_id\", sum(\"amount\") as \"balance\" from \"account_transactions\" group by \"account_transactions\".\"account_id\");"],"bps":true,"folderMillis":1731592154516,"hash":"d336aaabe84e24c6ee82768941c5c68c18b659fe34f9ba6b3e36b2aec884c66f"}]